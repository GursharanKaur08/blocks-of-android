
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>10. Retrofit Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-hints/plugin-hints.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-mathjax-commonhtml/mathjax.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../11-services/intro.html" />
    
    
    <link rel="prev" href="../09-recycler-view/intro.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../01-project-structure/intro.html">
            
                <a href="../01-project-structure/intro.html">
            
                    
                    1. Project Structure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../02-basic-widgets/basicandroidwidgets.html">
            
                <a href="../02-basic-widgets/basicandroidwidgets.html">
            
                    
                    2. Basic Widgets
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../03-list-view/intro.html">
            
                <a href="../03-list-view/intro.html">
            
                    
                    3. List View
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../03-list-view/03-1-custom-adapter.html">
            
                <a href="../03-list-view/03-1-custom-adapter.html">
            
                    
                    3.1 Custom Adapter
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../04-intents/implicit-and-explicit.html">
            
                <a href="../04-intents/implicit-and-explicit.html">
            
                    
                    4. Intents
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../04-intents/implicit-and-explicit.html">
            
                <a href="../04-intents/implicit-and-explicit.html">
            
                    
                    4.1 Implicit and Explicit intents
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../04-intents/assignments.html">
            
                <a href="../04-intents/assignments.html">
            
                    
                    4.2 Assignments
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../05-databases/intro.html">
            
                <a href="../05-databases/intro.html">
            
                    
                    5. Databases
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../06-broadcasts-receivers/intro.html">
            
                <a href="../06-broadcasts-receivers/intro.html">
            
                    
                    6. Broadcast Receivers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../07-asynctask/intro.html">
            
                <a href="../07-asynctask/intro.html">
            
                    
                    7. AsyncTask
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../08-network-operations/intro.html">
            
                <a href="../08-network-operations/intro.html">
            
                    
                    8. Network Operations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../09-recycler-view/intro.html">
            
                <a href="../09-recycler-view/intro.html">
            
                    
                    9. RecyclerView
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.11" data-path="intro.html">
            
                <a href="intro.html">
            
                    
                    10. Retrofit
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../11-services/intro.html">
            
                <a href="../11-services/intro.html">
            
                    
                    11. Services
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="../11-services/11-1-foreground-services.html">
            
                <a href="../11-services/11-1-foreground-services.html">
            
                    
                    11.1 Foreground Services
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2" data-path="../11-services/11-2-background-services.html">
            
                <a href="../11-services/11-2-background-services.html">
            
                    
                    11.2 Background Services
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3" data-path="../11-services/11-3-bound-services.html">
            
                <a href="../11-services/11-3-bound-services.html">
            
                    
                    11.3 Bound Services
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../12-alarms/intro.md">
            
                <span>
            
                    
                    12. Alarms
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../13-fragments/intro.html">
            
                <a href="../13-fragments/intro.html">
            
                    
                    13. Fragments
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="../13-fragments/13-1-static-fragments.html">
            
                <a href="../13-fragments/13-1-static-fragments.html">
            
                    
                    13.1 Static Fragments
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.2" data-path="../13-fragments/13-2-dynamic-fragments.html">
            
                <a href="../13-fragments/13-2-dynamic-fragments.html">
            
                    
                    13.2 Dynamic Fragments
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="../14-permissions/intro.html">
            
                <a href="../14-permissions/intro.html">
            
                    
                    14. Permissions
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.1" data-path="../14-permissions/14-1-runtime-permissions.html">
            
                <a href="../14-permissions/14-1-runtime-permissions.html">
            
                    
                    14.1 Runtime Permissions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="../15-location-and-sensors/intro.html">
            
                <a href="../15-location-and-sensors/intro.html">
            
                    
                    15. Location and Sensors
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.1" data-path="../15-location-and-sensors/15-1-location.html">
            
                <a href="../15-location-and-sensors/15-1-location.html">
            
                    
                    15.1 Location API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2" data-path="../15-location-and-sensors/15-2-sensors.html">
            
                <a href="../15-location-and-sensors/15-2-sensors.html">
            
                    
                    15.2 Sensors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.3" data-path="../15-location-and-sensors/15-3-camera.md">
            
                <span>
            
                    
                    15.3 Camera
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4" data-path="../15-location-and-sensors/assignments.html">
            
                <a href="../15-location-and-sensors/assignments.html">
            
                    
                    15.4 Assignments
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="../16-google-maps/intro.html">
            
                <a href="../16-google-maps/intro.html">
            
                    
                    16. Google Maps
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.17.1" data-path="../16-google-maps/16-1-maps-api.html">
            
                <a href="../16-google-maps/16-1-maps-api.html">
            
                    
                    16.1 Google Maps API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.2" data-path="../16-google-maps/16-2-creating-maps.html">
            
                <a href="../16-google-maps/16-2-creating-maps.html">
            
                    
                    16.2 Creating Maps
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.18" data-path="../17-firebase/intro.html">
            
                <a href="../17-firebase/intro.html">
            
                    
                    17. Firebase
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.18.1" data-path="../17-firebase/17-1-realtime-db.md">
            
                <span>
            
                    
                    17.1 Realtime Database
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.2" data-path="../17-firebase/17-2-push-notifications.md">
            
                <span>
            
                    
                    17.2 Push Notifications
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.19" data-path="../18-graphics-and-animations/intro.html">
            
                <a href="../18-graphics-and-animations/intro.html">
            
                    
                    18 Graphics and Animations
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.19.1" data-path="../18-graphics-and-animations/18-1-graphics.html">
            
                <a href="../18-graphics-and-animations/18-1-graphics.html">
            
                    
                    18.1 Graphics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.19.2" data-path="../18-graphics-and-animations/18-2-animations.html">
            
                <a href="../18-graphics-and-animations/18-2-animations.html">
            
                    
                    18.2 Animations
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >10. Retrofit</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="retrofit">Retrofit</h1>
<p>Retrofit is a REST Client for Android and Java by Square. It makes it relatively easy to retrieve and upload JSON (or other structured data) via a REST based webservice. In Retrofit you configure which converter is used for the data serialization. Typically for JSON you use GSon, but you can add custom converters to process XML or other protocols. Retrofit uses the OkHttp library for HTTP requests.</p>
<p>Retrofit 2 by default leverages OkHttp as the networking layer and is built on top of it.</p>
<h2 id="implementation-of-a-retrofit-2">Implementation of a Retrofit 2</h2>
<ul>
<li>Build a new project open your <code>build.grade</code>.</li>
</ul>
<pre><code class="lang-java">compile <span class="hljs-string">&apos;com.squareup.retrofit2:retrofit:2.1.0&apos;</span>
compile <span class="hljs-string">&apos;com.google.code.gson:gson:2.6.2&apos;</span>
compile <span class="hljs-string">&apos;com.squareup.retrofit2:converter-gson:2.1.0&apos;</span>
</code></pre>
<ul>
<li>OkHttp dependency is already shipped with Retrofit 2 dependency. If you wish to use a separate OkHttp dependency, you should exclude the OkHttp dependency from Retrofit 2 as:</li>
</ul>
<pre><code class="lang-java">compile (<span class="hljs-string">&apos;com.squareup.retrofit2:retrofit:2.1.0&apos;</span>) {
<span class="hljs-comment">// exclude Retrofit&#x2019;s OkHttp dependency module and define your own module import</span>
exclude module: <span class="hljs-string">&apos;okhttp&apos;</span>
}
compile <span class="hljs-string">&apos;com.google.code.gson:gson:2.6.2&apos;</span>
compile <span class="hljs-string">&apos;com.squareup.retrofit2:converter-gson:2.1.0&apos;</span>
compile <span class="hljs-string">&apos;com.squareup.okhttp3:logging-interceptor:3.4.1&apos;</span>
compile <span class="hljs-string">&apos;com.squareup.okhttp3:okhttp:3.4.1&apos;</span>
</code></pre>
<ul>
<li><p>The logging-interceptor generates a log string of the entire response that&#x2019;s returned.</p>
</li>
<li><p>Add the permission to access internet in the AndroidManifest.xml file.</p>
</li>
</ul>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">uses-permission</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;android.permission.INTERNET&quot;</span>/&gt;</span>
</code></pre>
<h1 id="okhttp-interceptors">OkHttp Interceptors</h1>
<p>Interceptors are a powerful mechanism present in OkHttp that can monitor, rewrite, and retry calls.<br>Interceptors can be majorly divided into two categories:</p>
<ul>
<li><p>Application Interceptors : To register an application interceptor, we need to call addInterceptor() on OkHttpClient.Builder</p>
</li>
<li><p>Network Interceptors : To register a Network Interceptor, invoke addNetworkInterceptor() instead of addInterceptor()</p>
</li>
</ul>
<h1 id="setting-up-the-retrofit-interface">Setting Up the Retrofit Interface</h1>
<p>The getClient() method in the below code will be called every time while setting up a Retrofit interface. Retrofit provides with a list of annotations for each of the HTTP methods: @GET, @POST, @PUT, @DELETE, @PATCH or @HEAD.</p>
<pre><code class="lang-java"><span class="hljs-keyword">package</span> Stonedcoder.coding-blocks.retrofit;

<span class="hljs-keyword">import</span> Stonedcoder.coding-blocks.retrofit.pojo.MultipleResource;
<span class="hljs-keyword">import</span> okhttp3.OkHttpClient;
<span class="hljs-keyword">import</span> okhttp3.logging.HttpLoggingInterceptor;
<span class="hljs-keyword">import</span> retrofit2.Retrofit;
<span class="hljs-keyword">import</span> retrofit2.converter.gson.GsonConverterFactory;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">APIClient</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Retrofit retrofit = <span class="hljs-keyword">null</span>;
    <span class="hljs-function"><span class="hljs-keyword">static</span> Retrofit <span class="hljs-title">getClient</span><span class="hljs-params">()</span> </span>{
        HttpLoggingInterceptor interceptor = <span class="hljs-keyword">new</span> HttpLoggingInterceptor();
        interceptor.setLevel(HttpLoggingInterceptor.Level.BODY);

        OkHttpClient client=newOkHttpClient.Builder().addInterceptor(interceptor).build();
        retrofit = <span class="hljs-keyword">new</span> Retrofit.Builder() .baseUrl(<span class="hljs-string">&quot;https://reqres.in&quot;</span>) .addConverterFactory(GsonConverterFactory.create()).client(client).build();
        <span class="hljs-keyword">return</span> retrofit;
    }
}
</code></pre>
<ul>
<li>Create a class <code>APIInterface.java</code> .</li>
</ul>
<pre><code class="lang-java"><span class="hljs-keyword">import</span> Stonedcoder.coding-blocks.retrofit.pojo.MultipleResource;
<span class="hljs-keyword">import</span> Stonedcoder.coding-blocks.retrofit.pojo.User;
<span class="hljs-keyword">import</span> Stonedcoder.coding-blocks.retrofit.pojo.UserList;

<span class="hljs-keyword">import</span> retrofit2.Call;
<span class="hljs-keyword">import</span> retrofit2.http.Body;
<span class="hljs-keyword">import</span> retrofit2.http.Field;
<span class="hljs-keyword">import</span> retrofit2.http.FormUrlEncoded;
<span class="hljs-keyword">import</span> retrofit2.http.GET;
<span class="hljs-keyword">import</span> retrofit2.http.POST;
<span class="hljs-keyword">import</span> retrofit2.http.Query;

<span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">APIInterface</span> </span>{

<span class="hljs-meta">@GET</span>(<span class="hljs-string">&quot;/api/unknown&quot;</span>)
<span class="hljs-function">Call&lt;MultipleResource&gt; <span class="hljs-title">doGetListResources</span><span class="hljs-params">()</span></span>;

<span class="hljs-meta">@POST</span>(<span class="hljs-string">&quot;/api/users&quot;</span>)
<span class="hljs-function">Call&lt;User&gt; <span class="hljs-title">createUser</span><span class="hljs-params">(@Body User user)</span></span>;

<span class="hljs-meta">@GET</span>(<span class="hljs-string">&quot;/api/users?&quot;</span>)
<span class="hljs-function">Call&lt;UserList&gt; <span class="hljs-title">doGetUserList</span><span class="hljs-params">(@Query(<span class="hljs-string">&quot;page&quot;</span>)</span> String page)</span>;

<span class="hljs-meta">@FormUrlEncoded</span>
<span class="hljs-meta">@POST</span>(<span class="hljs-string">&quot;/api/users?&quot;</span>)
<span class="hljs-function">Call&lt;UserList&gt; <span class="hljs-title">doCreateUserWithField</span><span class="hljs-params">(@Field(<span class="hljs-string">&quot;name&quot;</span>)</span> String name, @<span class="hljs-title">Field</span><span class="hljs-params">(<span class="hljs-string">&quot;job&quot;</span>)</span> String job)</span>;
}
</code></pre>
<ul>
<li>In the above class, we&#x2019;ve defined some methods that perform HTTP requests with annotation.</li>
</ul>
<p><code>@GET(&quot;/api/unknown&quot;) calls doGetListResources();</code></p>
<p><code>doGetListResources()</code> is the method name. MultipleResource.java is a Model POJO class for our response object that&#x2019;s used to map the response parameters to their respective variables. These POJO class act as the method return type.</p>
<ul>
<li>create a new POJO class for <code>MultipleResources.java</code></li>
</ul>
<pre><code class="lang-java"><span class="hljs-keyword">package</span> Stonedcoder.coding-blocks.retrofit.pojo;
<span class="hljs-keyword">import</span> com.google.gson.annotations.SerializedName;

<span class="hljs-keyword">import</span> java.util.ArrayList;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MultipleResource</span> </span>{

<span class="hljs-meta">@SerializedName</span>(<span class="hljs-string">&quot;page&quot;</span>)
<span class="hljs-keyword">public</span> Integer page;
<span class="hljs-meta">@SerializedName</span>(<span class="hljs-string">&quot;per_page&quot;</span>)
<span class="hljs-keyword">public</span> Integer perPage;
<span class="hljs-meta">@SerializedName</span>(<span class="hljs-string">&quot;total&quot;</span>)
<span class="hljs-keyword">public</span> Integer total;
<span class="hljs-meta">@SerializedName</span>(<span class="hljs-string">&quot;total_pages&quot;</span>)
<span class="hljs-keyword">public</span> Integer totalPages;
<span class="hljs-meta">@SerializedName</span>(<span class="hljs-string">&quot;data&quot;</span>)
<span class="hljs-keyword">public</span> List data = <span class="hljs-keyword">null</span>;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Datum</span> </span>{

<span class="hljs-meta">@SerializedName</span>(<span class="hljs-string">&quot;id&quot;</span>)
<span class="hljs-keyword">public</span> Integer id;
<span class="hljs-meta">@SerializedName</span>(<span class="hljs-string">&quot;name&quot;</span>)
<span class="hljs-keyword">public</span> String name;
<span class="hljs-meta">@SerializedName</span>(<span class="hljs-string">&quot;year&quot;</span>)
<span class="hljs-keyword">public</span> Integer year;
<span class="hljs-meta">@SerializedName</span>(<span class="hljs-string">&quot;pantone_value&quot;</span>)
<span class="hljs-keyword">public</span> String pantoneValue;

}
}
</code></pre>
<p><code>@SerializedName</code> annotation is used to specify the name of the field that&#x2019;s in the JSON Response.</p>
<p>To create a POJO class for each response, we can go to <a href="http://www.jsonschema2pojo.org/" target="_blank">http://www.jsonschema2pojo.org/</a> and paste the json response structure as shown below.</p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;page&quot;</span>: <span class="hljs-number">1</span>,
  <span class="hljs-string">&quot;per_page&quot;</span>: <span class="hljs-number">3</span>,
  <span class="hljs-string">&quot;total_pages&quot;</span>: <span class="hljs-number">4</span>,
  <span class="hljs-string">&quot;data&quot;</span>: [
    {
      <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-number">1</span>,
      <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;cerulean&quot;</span>,
      <span class="hljs-string">&quot;year&quot;</span>: <span class="hljs-number">2000</span>,
      <span class="hljs-string">&quot;pantone_value&quot;</span>: <span class="hljs-string">&quot;19-2031&quot;</span>
    },
    {
      <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-number">2</span>,
      <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;fuchsia rose&quot;</span>,
      <span class="hljs-string">&quot;year&quot;</span>: <span class="hljs-number">2001</span>,
      <span class="hljs-string">&quot;pantone_value&quot;</span>: <span class="hljs-string">&quot;20-2031&quot;</span>
    },
    {
      <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-number">3</span>,
      <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;true red&quot;</span>,
      <span class="hljs-string">&quot;year&quot;</span>: <span class="hljs-number">2002</span>,
      <span class="hljs-string">&quot;pantone_value&quot;</span>: <span class="hljs-string">&quot;21-2031&quot;</span>
    }
  ]
}
</code></pre>
<ul>
<li><p>The POJO classes are wrapped into a typed Retrofit Call class.</p>
</li>
<li><p>Method Parameters : There are a wide variety of possible options of parameters to pass inside a method:</p>
</li>
</ul>
<pre><code class="lang-java"><span class="hljs-meta">@Body</span> &#x2013; Sends Java objects as request body.
<span class="hljs-meta">@Url</span> &#x2013; use dynamic URLs.
<span class="hljs-meta">@Query</span> &#x2013; We can simply add a method parameter with <span class="hljs-meta">@Query</span>() and a query parameter name, describing the type. To URL encode a query use the form:
<span class="hljs-meta">@Query</span>(value = <span class="hljs-string">&quot;auth_token&quot;</span>,encoded = <span class="hljs-keyword">true</span>) String auth_token
<span class="hljs-meta">@Field</span> &#x2013; send data as form-urlencoded. This requires a <span class="hljs-meta">@FormUrlEncoded</span> annotation attached with the method.
</code></pre>
<p>The @Field parameter works only with a POST</p>
<ul>
<li>Note: @Field requires a mandatory parameter. In cases when <code>@Field</code> is optional, we can use <code>@Query</code> instead and pass a null value.</li>
</ul>
<p>The pojo package defines four model classes for each of the API endpoint responses defined in the <code>APIInterface.java</code> class.</p>
<ul>
<li>Create a class <code>User.java</code></li>
</ul>
<pre><code class="lang-java"><span class="hljs-keyword">package</span> Stonedcoder.coding-blocks.retrofit.pojo;
<span class="hljs-keyword">import</span> com.google.gson.annotations.SerializedName;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>{

<span class="hljs-meta">@SerializedName</span>(<span class="hljs-string">&quot;name&quot;</span>)
<span class="hljs-keyword">public</span> String name;
<span class="hljs-meta">@SerializedName</span>(<span class="hljs-string">&quot;job&quot;</span>)
<span class="hljs-keyword">public</span> String job;
<span class="hljs-meta">@SerializedName</span>(<span class="hljs-string">&quot;id&quot;</span>)
<span class="hljs-keyword">public</span> String id;
<span class="hljs-meta">@SerializedName</span>(<span class="hljs-string">&quot;createdAt&quot;</span>)
<span class="hljs-keyword">public</span> String createdAt;

<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">User</span><span class="hljs-params">(String name, String job)</span> </span>{
<span class="hljs-keyword">this</span>.name = name;
<span class="hljs-keyword">this</span>.job = job;
}
}
</code></pre>
<p>The above class is used to create the Response Body for the <code>createUser()</code> method.</p>
<ul>
<li>Create a class <code>UserList.java</code></li>
</ul>
<pre><code class="lang-java"><span class="hljs-keyword">package</span> Stonedcoder.coding-blocks.retrofit.pojo;
<span class="hljs-keyword">import</span> com.google.gson.annotations.SerializedName;

<span class="hljs-keyword">import</span> java.util.ArrayList;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserList</span> </span>{

<span class="hljs-meta">@SerializedName</span>(<span class="hljs-string">&quot;page&quot;</span>)
<span class="hljs-keyword">public</span> Integer page;
<span class="hljs-meta">@SerializedName</span>(<span class="hljs-string">&quot;per_page&quot;</span>)
<span class="hljs-keyword">public</span> Integer perPage;
<span class="hljs-meta">@SerializedName</span>(<span class="hljs-string">&quot;total&quot;</span>)
<span class="hljs-keyword">public</span> Integer total;
<span class="hljs-meta">@SerializedName</span>(<span class="hljs-string">&quot;total_pages&quot;</span>)
<span class="hljs-keyword">public</span> Integer totalPages;
<span class="hljs-meta">@SerializedName</span>(<span class="hljs-string">&quot;data&quot;</span>)
<span class="hljs-keyword">public</span> List data = <span class="hljs-keyword">new</span> ArrayList();

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Datum</span> </span>{

<span class="hljs-meta">@SerializedName</span>(<span class="hljs-string">&quot;id&quot;</span>)
<span class="hljs-keyword">public</span> Integer id;
<span class="hljs-meta">@SerializedName</span>(<span class="hljs-string">&quot;first_name&quot;</span>)
<span class="hljs-keyword">public</span> String first_name;
<span class="hljs-meta">@SerializedName</span>(<span class="hljs-string">&quot;last_name&quot;</span>)
<span class="hljs-keyword">public</span> String last_name;
<span class="hljs-meta">@SerializedName</span>(<span class="hljs-string">&quot;avatar&quot;</span>)
<span class="hljs-keyword">public</span> String avatar;

}
}
</code></pre>
<ul>
<li>Create <code>UserResponse.java</code></li>
</ul>
<pre><code class="lang-java"><span class="hljs-keyword">package</span> Stonedcoder.coding-blocks.retrofit.pojo;
<span class="hljs-keyword">import</span> com.google.gson.annotations.SerializedName;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CreateUserResponse</span> </span>{

<span class="hljs-meta">@SerializedName</span>(<span class="hljs-string">&quot;name&quot;</span>)
<span class="hljs-keyword">public</span> String name;
<span class="hljs-meta">@SerializedName</span>(<span class="hljs-string">&quot;job&quot;</span>)
<span class="hljs-keyword">public</span> String job;
<span class="hljs-meta">@SerializedName</span>(<span class="hljs-string">&quot;id&quot;</span>)
<span class="hljs-keyword">public</span> String id;
<span class="hljs-meta">@SerializedName</span>(<span class="hljs-string">&quot;createdAt&quot;</span>)
<span class="hljs-keyword">public</span> String createdAt;
}
</code></pre>
<ul>
<li>The <code>MainActivity.java</code> is where we call each of the API endpoints defined in the Interface class and display each of the fields in a Toast/TextView.</li>
</ul>
<pre><code class="lang-java"><span class="hljs-keyword">import</span> android.support.v7.app.AppCompatActivity;
<span class="hljs-keyword">import</span> android.os.Bundle;
<span class="hljs-keyword">import</span> android.util.Log;
<span class="hljs-keyword">import</span> android.widget.TextView;
<span class="hljs-keyword">import</span> android.widget.Toast;

<span class="hljs-keyword">import</span> Stonedcoder.coding-blocks.retrofit.pojo.CreateUserResponse;
<span class="hljs-keyword">import</span> Stonedcoder.coding-blocks.retrofit.pojo.MultipleResource;
<span class="hljs-keyword">import</span> Stonedcoder.coding-blocks.retrofit.pojo.User;
<span class="hljs-keyword">import</span> Stonedcoder.coding-blocks.retrofit.UserList;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">import</span> retrofit2.Call;
<span class="hljs-keyword">import</span> retrofit2.Callback;
<span class="hljs-keyword">import</span> retrofit2.Response;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AppCompatActivity</span> </span>{

TextView responseText;
APIInterface apiInterface;

<span class="hljs-meta">@Override</span>
<span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> </span>{
<span class="hljs-keyword">super</span>.onCreate(savedInstanceState);
setContentView(R.layout.activity_main);
responseText = (TextView) findViewById(R.id.responseText);
apiInterface = APIClient.getClient().create(APIInterface.class);


<span class="hljs-comment">/**
GET List Resources
**/</span>
Call call = apiInterface.doGetListResources();
call.enqueue(<span class="hljs-keyword">new</span> Callback() {
<span class="hljs-meta">@Override</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onResponse</span><span class="hljs-params">(Call call, Response response)</span> </span>{

Log.d(<span class="hljs-string">&quot;TAG&quot;</span>,response.code()+<span class="hljs-string">&quot;&quot;</span>);

String displayResponse = <span class="hljs-string">&quot;&quot;</span>;

MultipleResource resource = response.body();
Integer text = resource.page;
Integer total = resource.total;
Integer totalPages = resource.totalPages;
List datumList = resource.data;

displayResponse += text + <span class="hljs-string">&quot; Page\n&quot;</span> + total + <span class="hljs-string">&quot; Total\n&quot;</span> + totalPages + <span class="hljs-string">&quot; Total Pages\n&quot;</span>;

<span class="hljs-keyword">for</span> (MultipleResource.Datum datum : datumList) {
displayResponse += datum.id + <span class="hljs-string">&quot; &quot;</span> + datum.name + <span class="hljs-string">&quot; &quot;</span> + datum.pantoneValue + <span class="hljs-string">&quot; &quot;</span> + datum.year + <span class="hljs-string">&quot;\n&quot;</span>;
}

responseText.setText(displayResponse);

}

<span class="hljs-meta">@Override</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onFailure</span><span class="hljs-params">(Call call, Throwable t)</span> </span>{
call.cancel();
}
});

<span class="hljs-comment">/**
Create new user
**/</span>
User user = <span class="hljs-keyword">new</span> User(<span class="hljs-string">&quot;morpheus&quot;</span>, <span class="hljs-string">&quot;leader&quot;</span>);
Call call1 = apiInterface.createUser(user);
call1.enqueue(<span class="hljs-keyword">new</span> Callback() {
<span class="hljs-meta">@Override</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onResponse</span><span class="hljs-params">(Call call, Response response)</span> </span>{
User user1 = response.body();

Toast.makeText(getApplicationContext(), user1.name + <span class="hljs-string">&quot; &quot;</span> + user1.job + <span class="hljs-string">&quot; &quot;</span> + user1.id + <span class="hljs-string">&quot; &quot;</span> + user1.createdAt, Toast.LENGTH_SHORT).show();

}

<span class="hljs-meta">@Override</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onFailure</span><span class="hljs-params">(Call call, Throwable t)</span> </span>{
call.cancel();
}
});

<span class="hljs-comment">/**
GET List Users
**/</span>
Call call2 = apiInterface.doGetUserList(<span class="hljs-string">&quot;2&quot;</span>);
call2.enqueue(<span class="hljs-keyword">new</span> Callback() {
<span class="hljs-meta">@Override</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onResponse</span><span class="hljs-params">(Call call, Response response)</span> </span>{

UserList userList = response.body();
Integer text = userList.page;
Integer total = userList.total;
Integer totalPages = userList.totalPages;
List datumList = userList.data;
Toast.makeText(getApplicationContext(), text + <span class="hljs-string">&quot; page\n&quot;</span> + total + <span class="hljs-string">&quot; total\n&quot;</span> + totalPages + <span class="hljs-string">&quot; totalPages\n&quot;</span>, Toast.LENGTH_SHORT).show();

<span class="hljs-keyword">for</span> (UserList.Datum datum : datumList) {
Toast.makeText(getApplicationContext(), <span class="hljs-string">&quot;id : &quot;</span> + datum.id + <span class="hljs-string">&quot; name: &quot;</span> + datum.first_name + <span class="hljs-string">&quot; &quot;</span> + datum.last_name + <span class="hljs-string">&quot; avatar: &quot;</span> + datum.avatar, Toast.LENGTH_SHORT).show();
}


}

<span class="hljs-meta">@Override</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onFailure</span><span class="hljs-params">(Call call, Throwable t)</span> </span>{
call.cancel();
}
});


<span class="hljs-comment">/**
POST name and job Url encoded.
**/</span>
Call call3 = apiInterface.doCreateUserWithField(<span class="hljs-string">&quot;morpheus&quot;</span>,<span class="hljs-string">&quot;leader&quot;</span>);
call3.enqueue(<span class="hljs-keyword">new</span> Callback() {
<span class="hljs-meta">@Override</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onResponse</span><span class="hljs-params">(Call call, Response response)</span> </span>{
UserList userList = response.body();
Integer text = userList.page;
Integer total = userList.total;
Integer totalPages = userList.totalPages;
List datumList = userList.data;
Toast.makeText(getApplicationContext(), text + <span class="hljs-string">&quot; page\n&quot;</span> + total + <span class="hljs-string">&quot; total\n&quot;</span> + totalPages + <span class="hljs-string">&quot; totalPages\n&quot;</span>, Toast.LENGTH_SHORT).show();

<span class="hljs-keyword">for</span> (UserList.Datum datum : datumList) {
Toast.makeText(getApplicationContext(), <span class="hljs-string">&quot;id : &quot;</span> + datum.id + <span class="hljs-string">&quot; name: &quot;</span> + datum.first_name + <span class="hljs-string">&quot; &quot;</span> + datum.last_name + <span class="hljs-string">&quot; avatar: &quot;</span> + datum.avatar, Toast.LENGTH_SHORT).show();
}

}

<span class="hljs-meta">@Override</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onFailure</span><span class="hljs-params">(Call call, Throwable t)</span> </span>{
call.cancel();
}
});

}
}
</code></pre>
<p><code>apiInterface = APIClient.getClient().create(APIInterface.class);</code> is used to instantiate the APIClient.<br>To map the Model class to the response we use:</p>
<p><code>MultipleResource resource = response.body();</code></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../09-recycler-view/intro.html" class="navigation navigation-prev " aria-label="Previous page: 9. RecyclerView">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../11-services/intro.html" class="navigation navigation-next " aria-label="Next page: 11. Services">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"10. Retrofit","level":"1.11","depth":1,"next":{"title":"11. Services","level":"1.12","depth":1,"path":"11-services/intro.md","ref":"11-services/intro.md","articles":[{"title":"11.1 Foreground Services","level":"1.12.1","depth":2,"path":"11-services/11-1-foreground-services.md","ref":"11-services/11-1-foreground-services.md","articles":[]},{"title":"11.2 Background Services","level":"1.12.2","depth":2,"path":"11-services/11-2-background-services.md","ref":"11-services/11-2-background-services.md","articles":[]},{"title":"11.3 Bound Services","level":"1.12.3","depth":2,"path":"11-services/11-3-bound-services.md","ref":"11-services/11-3-bound-services.md","articles":[]}]},"previous":{"title":"9. RecyclerView","level":"1.10","depth":1,"path":"09-recycler-view/intro.md","ref":"09-recycler-view/intro.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["json","hints","mathjax-commonhtml","youtube"],"pluginsConfig":{"youtube":{},"json":{"output":"_book/book.json"},"search":{},"mathjax-commonhtml":{"defaultScaling":true},"hints":{"danger":"fa fa-exclamation-circle","info":"fa fa-info-circle","tip":"fa fa-mortar-board","working":"fa fa-wrench"},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"10-retrofit/intro.md","mtime":"2019-01-26T18:10:45.569Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-01-26T18:12:04.430Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

